<div class="spinner-overlay" *ngIf="_show_spinner" >
    <div class="spinner-container">
      <mat-spinner></mat-spinner>
    </div>
</div>
<div class="module-workarea p-4 ">

    <div class="text-secondary d-flex align-item-center m-0 p-0">
         <mat-icon>{{modulo.icono}}</mat-icon>
         <span class="fs-5">{{modulo.nombre}}</span>
    </div>
    <hr>
    <div class="form-section">

        <form [formGroup]="clienteForm" class="mb-2" (ngSubmit)="onSubmit()">
            <div class=" d-flex justify-content-between  flex-wrap    ">
                <div class="mb-3 col-2 ">
                    <label for="ruc" class="form-label">
                        R.U.C.: <span class="text-danger">*</span>
                    </label>
                    <input type="text" class="form-control"
                           formControlName="ruc" #ruc id="ruc" 
                           (keyup)="validarCadena($event, 'ruc', 'N')">
                </div>
                <div class="mb-3 col-5">
                    <label for="nombre" class="form-label">
                        Nombre del Cliente (Empresa):<span class="text-danger">*</span>
                    </label>
                    <input type="text" class="form-control" (keyup)="validarCadena($event, 'nombre', 'L')"
                           formControlName="nombre" 
                           #nombre id="nombre"
                           placeholder="Corporación Naranja S.A.">
                </div>
                <div class="mb-3 col-4 ">
                    <label for="replegal" class="form-label   ">
                        Representante Legal:<span class="text-danger">*</span>
                    </label>
                    <input type="text"  class="form-control" 
                           (keyup)="validarCadena($event, 'ruc', 'L')"
                           formControlName="replegal" #replegal id="replegal" placeholder="Abg. Mauricio Pimentel">
                </div>
            </div>
            <div  class=" d-flex justify-content-between  flex-wrap    "  >
            <div class="mb-3 col-5 ">
                <label for="descripcion" class="form-label   ">
                    Descripcion:
                </label>
                <input type="text" class="form-control" (keyup)="validarCadena($event, 'descripcion', 'L')"  formControlName="descripcion" #descripcion id="descripcion" placeholder="Empresa dedicada a elaborar...">
            </div>
            <div class="mb-3 col-6 ">
                <label for="observacion" class="form-label   ">
                    Observacion:
                </label>
                <input type="text" class="form-control" (keyup)="validarCadena($event, 'observacion', 'L')"  formControlName="observacion" 
                       #observacion id="observacion" placeholder="La persona que se encarga de dar paso se llama Juan Mendoza guardia de seguridad...">
            </div>
            </div>
            <div  class=" d-flex justify-content-start  flex-wrap    "  >
                <div class="m-2 col-3 ">
                    <label for="telfpago" class="form-label   ">
                        Nombre persona mantenimiento: 
                        <br>
                        <!-- <small class="text-secondary">Teléfono de la persona encargada del pago por nuestros servicios.</small> -->
                    </label>
                    <input type="text" class="form-control" (keyup)="validarCadena($event, 'nombreMantenimiento', 'L')"  formControlName="nombreMantenimiento" #nombreMantenimiento id="nombreMantenimiento" placeholder="Carlos Vera">
                </div>
                <div class="m-2 col-3 ">
                    <label for="telfclimanteni" class="form-label   ">
                        Telefono mantenimiento: <span class="text-danger">*</span>
                        <br>
                        <small class="text-secondary">Teléfono de la persona encargada del mantenimiento por parte del cliente.</small>
                    </label>
                    <input type="text" class="form-control" (keyup)="validarCadena($event, 'telfclimanteni', 'N')"  formControlName="telfclimanteni" #telfclimanteni id="telfclimanteni" placeholder="0987654321">
                </div>
                <div class="m-2 col-4 ">
                    <label for="correomantenimiento" class="form-label   ">
                        Email mantenimiento: <span class="text-danger">*</span>
                        <br>
                        <small class="text-secondary">Email de la persona encargada del mantenimiento por parte del cliente.</small>
                    </label>
                    <input type="email" class="form-control" formControlName="correomantenimiento" #correomantenimiento id="correomantenimiento" placeholder="mateni@mail.com">
                </div>
            </div>
            <div  class=" d-flex justify-content-start  flex-wrap    "  >
                <div class="m-2 col-3 ">
                    <label for="telfpago" class="form-label   ">
                        Nombre persona cobro: 
                        <br>
                        <!-- <small class="text-secondary">Teléfono de la persona encargada del pago por nuestros servicios.</small> -->
                    </label>
                    <input type="text" class="form-control" (keyup)="validarCadena($event, 'nombrePago', 'L')"  formControlName="nombrePago" #nombrePago id="nombrePago" placeholder="Paola Gonzabay">
                </div>
                <div class="m-2 col-3 ">
                    <label for="telfpago" class="form-label   ">
                        Telf. cobro: <span class="text-danger">*</span>
                        <br>
                        <small class="text-secondary">Teléfono de la persona encargada del pago por nuestros servicios.</small>
                    </label>
                    <input type="text" class="form-control" (keyup)="validarCadena($event, 'ruc', 'N')"  formControlName="telfpago" #telfpago id="telfpago" placeholder="0987654321">
                </div>
                <div class="m-2 col-4 ">
                    <label for="telfpago" class="form-label   ">
                        Email cobro: <span class="text-danger">*</span>
                        <br>
                        <small class="text-secondary">Email de la persona encargada del pago por nuestros servicios. <br>
                        &nbsp;&nbsp;&nbsp;                       
                        </small>
                    </label>
                    <input type="email" class="form-control" formControlName="correopago" #correopago id="correopago" placeholder="pago@mail.com">
                </div>
            </div>
            <div  class=" d-flex justify-content-between  flex-wrap    "  >
                <div class="mb-3 col-3  ">
                    <label for="tipo" class="form-label ">
                        Tipo de persona:
                    </label>
                    <select class="inpForms form-select   w-100"
                            formControlName="tipo" #tipo id="tipo" aria-label="">
                            <option *ngFor="let tipo of tipoEmpresaLista" [value]="tipo.codigo" >
                                {{tipo.nombre | titlecase }}                                
                            </option>
                    </select>
                </div>
                <div class="mb-3 col-4 ">
                    <label for="fechacontinicio" class="form-label   ">
                        Fecha inicial del contrato:
                    </label>
                    <input type="date" class="form-control" formControlName="fechacontinicio" #fechacontinicio id="fechacontinicio" >
                </div>
                <div class="mb-3 col-4 ">
                    <label for="fechacontfinal" class="form-label   ">
                        Fecha final del contrato:
                    </label>
                    <input type="date" class="form-control" formControlName="fechacontfinal" #fechacontfinal id="fechacontfinal" >
                </div>
            </div>
            <div class="floating-button">

                <button mat-raised-button type="button" color="warn" *ngIf="_cancel_button" (click)="limpiar()" >
                    <mat-icon>cancel</mat-icon>
                </button>
                <button type="submit" mat-raised-button color="primary">
                    <mat-icon>{{_icon_button}}</mat-icon> {{_action_butto}} {{modulo.nombre}}
                </button>

            </div>

        </form>

    </div>

</div>


<div class="module-workarea p-4 mt-3 ">
    <div class="text-secondary d-flex align-item-center m-0 p-0">
         <mat-icon>{{modulo.icono}}</mat-icon><span class="fs-5" > {{modulo.nombre}} Registrados  </span>
    </div>
    <hr>
    <div class="table-responsive w-100">
        <section class="filtros  mb-2">
            <!-- <input type="text" class="form-control" > -->
            <small class="text-secondary">
                Cantidad de clientes registrados 
                <strong class="text-primary">
                   ( {{listaClientes.length}} )
                </strong>
            </small>
            <div class="mb-2 d-flex">
              <input class=" w-100 form-control rounded-pill"
                     fxFlex="auto" type="text"
                     (keyup)="applyFilter($event)" 
                     #input placeholder="Búsqueda de clientes registrados....">
            </div>        
    
        </section>
        <table mat-table [dataSource]="dataSource" class="mtTable shadow" matSort class="w-100" >
    
            <ng-container matColumnDef="edit">
                
                <th mat-header-cell *matHeaderCellDef mat-sort-header>
                  <span>
                    <mat-icon>
                      edit
                    </mat-icon>
                  </span>
                  <span *ngIf="_delete_show" >
                    <mat-icon>
                      delete
                    </mat-icon>
                  </span>
                </th>
                
                <td mat-cell *matCellDef="let row">
                  <span class="edit" (click)="catchData(row)">
                    <mat-icon>
                      edit
                    </mat-icon>
                  </span>
                  <span *ngIf="_delete_show" class="delete" (click)="eliminarClientes(row)">
                    <mat-icon  >
                      delete
                    </mat-icon>
                  </span>
                </td>
    
              </ng-container>    
    
            <ng-container matColumnDef="N.Agen." >
                <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    N.Agen.
                </th>
                <td style="cursor: pointer;" mat-cell 
                    *matCellDef="let row"
                    >
                    <button mat-mini-fab color="accent" >
                        {{row.numeroAgencia}}
                    </button>
                </td>
            </ng-container>    
    
            <ng-container matColumnDef="nombre" >
                <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    Nombre
                </th>
                <td style="cursor: pointer;" mat-cell 
                    *matCellDef="let row" 
                    [matTooltip]="'Nombre Mant.: ' +row.nombreMantenimiento+ '  Telf Mant.: ' + row.telfclimanteni +'  Correo: '+ row.correomantenimiento +'Nombre Cobro:  ' +row.nombrePago+  '   Telf. Cobro: ' + row.telfpago + '    Correo: ' + row.correopago + ' Observacion: ' + row.observacion">
                  {{row.nombre}}
                </td>
            </ng-container>
    
            <ng-container matColumnDef="R.U.C.">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    R.U.C.
                </th>
                <td mat-cell *matCellDef="let row">
                  {{row.ruc}}
                </td>
            </ng-container>

            <ng-container matColumnDef="replegal">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    Representante Legal
                </th>
                <td mat-cell *matCellDef="let row">
                  {{row.replegal}}
                </td>
            </ng-container>

            <ng-container matColumnDef="descripcion">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    Descripción
                </th>
                <td mat-cell *matCellDef="let row">
                  {{row.descripcion}}
                </td>
            </ng-container>
            <ng-container matColumnDef="fechas">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    Fechas Contratación
                </th>
                <td mat-cell *matCellDef="let row">
                  <span class="text-secondary" > F.I.: </span> {{row.fechacontinicio | date: 'dd-MM-yyyy'}} <span class="text-secondary"> F.F.: </span>{{row.fechacontfinal | date: 'dd-MMMM-yyyy'}} 
                </td>
            </ng-container>
    
            <tr mat-header-row *matHeaderRowDef="columnHead"></tr>
            <tr mat-row *matRowDef="let row; columns: columnHead;"></tr>
        
            <!-- Row shown when there is no matching data. -->
            <tr class="mat-row" *matNoDataRow>
              <td class="mat-cell" colspan="4">
                Datos no encontrados...
              </td>
            </tr>
        </table>
        <mat-paginator [length]="100"
                       [pageSize]="10"
                       [pageSizeOptions]="[5, 10, 25, 100]"
                       aria-label="Select page">
    </mat-paginator>    
    </div>
    </div>
    